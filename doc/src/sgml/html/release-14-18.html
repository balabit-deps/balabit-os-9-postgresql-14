<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.2. Release 14.18</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="release-14-19.html" title="E.1. Release 14.19" /><link rel="next" href="release-14-17.html" title="E.3. Release 14.17" /></head><body id="docContent" class="container-fluid col-10"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.2. Release 14.18</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-14-19.html" title="E.1. Release 14.19">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. Release Notes">Up</a></td><th width="60%" align="center">Appendix E. Release Notes</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 14.19 Documentation">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-14-17.html" title="E.3. Release 14.17">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-14-18"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.2. Release 14.18</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-14-18.html#id-1.11.6.7.4">E.2.1. Migration to Version 14.18</a></span></dt><dt><span class="sect2"><a href="release-14-18.html#id-1.11.6.7.5">E.2.2. Changes</a></span></dt></dl></div><p><strong>Release date: </strong>2025-05-08</p><p>
   This release contains a variety of fixes from 14.17.
   For information about new features in major release 14, see
   <a class="xref" href="release-14.html" title="E.20. Release 14">Section E.20</a>.
  </p><div class="sect2" id="id-1.11.6.7.4"><div class="titlepage"><div><div><h3 class="title">E.2.1. Migration to Version 14.18</h3></div></div></div><p>
    A dump/restore is not required for those running 14.X.
   </p><p>
    However, if you have any self-referential foreign key constraints on
    partitioned tables, it may be necessary to recreate those constraints
    to ensure that they are being enforced correctly.  See the second
    changelog entry below.
   </p><p>
    Also, if you have any BRIN bloom indexes, it may be advisable to
    reindex them after updating.  See the third changelog entry below.
   </p><p>
    Also, if you are upgrading from a version earlier than 14.14,
    see <a class="xref" href="release-14-14.html" title="E.6. Release 14.14">Section E.6</a>.
   </p></div><div class="sect2" id="id-1.11.6.7.5"><div class="titlepage"><div><div><h3 class="title">E.2.2. Changes</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
      Avoid one-byte buffer overread when examining invalidly-encoded
      strings that are claimed to be in GB18030 encoding
      (Noah Misch, Andres Freund)
      <a class="ulink" href="https://postgr.es/c/3f2ab7393" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/258cde839" target="_top">§</a>
     </p><p>
      While unlikely, a SIGSEGV crash could occur if an incomplete
      multibyte character appeared at the end of memory.  This was
      possible both in the server and
      in <span class="application">libpq</span>-using applications.
      (CVE-2025-4207)
     </p></li><li class="listitem"><p>
      Handle self-referential foreign keys on partitioned tables correctly
      (Álvaro Herrera)
      <a class="ulink" href="https://postgr.es/c/1649d153a" target="_top">§</a>
     </p><p>
      Creating or attaching partitions failed to make the required catalog
      entries for a foreign-key constraint, if the table referenced by the
      constraint was the same partitioned table.  This resulted in failure
      to enforce the constraint fully.
     </p><p>
      To fix this, you should drop and recreate any self-referential
      foreign keys on partitioned tables, if partitions have been created
      or attached since the constraint was created.  Bear in mind that
      violating rows might already be present, in which case recreating
      the constraint will fail, and you'll need to fix up those rows
      before trying again.
     </p></li><li class="listitem"><p>
      Avoid data loss when merging compressed BRIN summaries
      in <code class="function">brin_bloom_union()</code> (Tomas Vondra)
      <a class="ulink" href="https://postgr.es/c/6be02bbc8" target="_top">§</a>
     </p><p>
      The code failed to account for decompression results not being
      identical to the input objects, which would result in failure to add
      some of the data to the merged summary, leading to missed rows in
      index searches.
     </p><p>
      This mistake was present back to v14 where BRIN bloom indexes were
      introduced, but this code path was only rarely reached then.  It's
      substantially more likely to be hit in v17 because parallel index
      builds now use the code.
     </p></li><li class="listitem"><p>
      Fix unexpected <span class="quote">“<span class="quote">attribute has wrong type</span>”</span> errors
      in <code class="command">UPDATE</code>, <code class="command">DELETE</code>,
      and <code class="command">MERGE</code> queries that use whole-row table
      references to views or functions in <code class="literal">FROM</code>
      (Tom Lane)
      <a class="ulink" href="https://postgr.es/c/d3a29ae6a" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/584f17a90" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/1a20bc946" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Prevent failure in <code class="command">INSERT</code> commands when the table
      has a <code class="literal">GENERATED</code> column of a domain data type and
      the domain's constraints disallow null values (Jian He)
      <a class="ulink" href="https://postgr.es/c/4604928ed" target="_top">§</a>
     </p><p>
      Constraint failure was reported even if the generation expression
      produced a perfectly okay result.
     </p></li><li class="listitem"><p>
      Correctly process references to outer CTE names that appear within
      a <code class="literal">WITH</code> clause attached to
      an <code class="command">INSERT</code>/<code class="command">UPDATE</code>/<code class="command">DELETE</code>/<code class="command">MERGE</code>
      command that's inside <code class="literal">WITH</code> (Tom Lane)
      <a class="ulink" href="https://postgr.es/c/754a3d82d" target="_top">§</a>
     </p><p>
      The parser failed to detect disallowed recursion cases, nor did it
      account for such references when sorting CTEs into a usable order.
     </p></li><li class="listitem"><p>
      Fix <code class="literal">ARRAY(<em class="replaceable"><code>subquery</code></em>)</code>
      and <code class="literal">ARRAY[<em class="replaceable"><code>expression, ...</code></em>]</code>
      constructs to produce sane results when the input is of
      type <code class="type">int2vector</code> or <code class="type">oidvector</code> (Tom Lane)
      <a class="ulink" href="https://postgr.es/c/f7ae51312" target="_top">§</a>
     </p><p>
      This patch restores the behavior that existed
      before <span class="productname">PostgreSQL</span> 9.5: the result is of
      type <code class="type">int2vector[]</code> or <code class="type">oidvector[]</code>.
     </p></li><li class="listitem"><p>
      Fix possible erroneous reports of invalid affixes while parsing
      <span class="application">Ispell</span> dictionaries (Jacob Brazeal)
      <a class="ulink" href="https://postgr.es/c/da85544ae" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Fix <code class="literal">ALTER TABLE ADD COLUMN</code> to correctly handle
      the case of a domain type that has a default
      (Jian He, Tom Lane, Tender Wang)
      <a class="ulink" href="https://postgr.es/c/c75c830e2" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/d31d39cfe" target="_top">§</a>
     </p><p>
      If a domain type has a default, adding a column of that type (without
      any explicit <code class="literal">DEFAULT</code>
      clause) failed to install the domain's default
      value in existing rows, instead leaving the new column null.
     </p></li><li class="listitem"><p>
      Improve the error message for disallowed attempts to alter the
      properties of a foreign key constraint (Álvaro Herrera)
      <a class="ulink" href="https://postgr.es/c/931a1c023" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Avoid error when resetting
      the <code class="structfield">relhassubclass</code> flag of a temporary
      table that's marked <code class="literal">ON COMMIT DELETE ROWS</code>
      (Noah Misch)
      <a class="ulink" href="https://postgr.es/c/a61b67cd0" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Fix planner's failure to identify more than one hashable
      ScalarArrayOpExpr subexpression within a top-level expression
      (David Geier)
      <a class="ulink" href="https://postgr.es/c/b68f664bb" target="_top">§</a>
     </p><p>
      This resulted in unnecessarily-inefficient execution of any
      additional subexpressions that could have been processed with a hash
      table (that is, <code class="literal">IN</code>, <code class="literal">NOT IN</code>,
      or <code class="literal">= ANY</code> clauses with all-constant right-hand
      sides).
     </p></li><li class="listitem"><p>
      Disable <span class="quote">“<span class="quote">skip fetch</span>”</span> optimization in bitmap heap scan
      (Matthias van de Meent)
      <a class="ulink" href="https://postgr.es/c/4934d3875" target="_top">§</a>
     </p><p>
      It turns out that this optimization can result in returning dead
      tuples when a concurrent vacuum marks a page all-visible.
     </p></li><li class="listitem"><p>
      Fix performance issues in GIN index search startup when there are
      many search keys (Tom Lane, Vinod Sridharan)
      <a class="ulink" href="https://postgr.es/c/e2a6934a8" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/1b47a112a" target="_top">§</a>
     </p><p>
      An indexable clause with many keys (for example, <code class="literal">jsonbcol
      ?| array[...]</code> with tens of thousands of array elements)
      took O(N<sup>2</sup>) time to start up, and was
      uncancelable for that interval too.
     </p></li><li class="listitem"><p>
      Detect missing support procedures in a BRIN index operator class,
      and report an error instead of crashing (Álvaro Herrera)
      <a class="ulink" href="https://postgr.es/c/5144e1f8f" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Respond to interrupts (such as query cancel) while waiting for
      asynchronous subplans of an Append plan node (Heikki Linnakangas)
      <a class="ulink" href="https://postgr.es/c/d2fb076be" target="_top">§</a>
     </p><p>
      Previously, nothing would happen until one of the subplans becomes
      ready.
     </p></li><li class="listitem"><p>
      Fix race condition in handling
      of <code class="varname">synchronous_standby_names</code> immediately after
      startup (Melnikov Maksim, Michael Paquier)
      <a class="ulink" href="https://postgr.es/c/873aff945" target="_top">§</a>
     </p><p>
      For a short period after system startup, backends might fail to wait
      for synchronous commit even
      though <code class="varname">synchronous_standby_names</code> is enabled.
     </p></li><li class="listitem"><p>
      Fix <code class="function">pg_strtof()</code> to not crash with null endptr
      (Alexander Lakhin, Tom Lane)
      <a class="ulink" href="https://postgr.es/c/76fbb38ef" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Avoid crash when a Snowball stemmer encounters an out-of-memory
      condition (Maksim Korotkov)
      <a class="ulink" href="https://postgr.es/c/8388cae55" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Skip WAL recycling and preallocation during archive recovery, to
      avoid corruption of WAL files that were restored from the archive
      (Noah Misch, Arun Thirupathi)
      <a class="ulink" href="https://postgr.es/c/3635a0a35" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/014a50800" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/675b771ca" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/b494640e8" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/8967dddf0" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/6b168c129" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/47d2d2982" target="_top">§</a>
     </p><p>
      This change back-patches v15-era fixes that were considered largely
      cosmetic at the time, but turn out to prevent data corruption in the
      wake of subsequent fixes.
     </p></li><li class="listitem"><p>
      Prevent over-advancement of catalog xmin in <span class="quote">“<span class="quote">fast
      forward</span>”</span> mode of logical decoding (Zhijie Hou)
      <a class="ulink" href="https://postgr.es/c/1f63b3626" target="_top">§</a>
     </p><p>
      This mistake could allow deleted catalog entries to be vacuumed away
      even though they were still potentially needed by the WAL-reading
      process.
     </p></li><li class="listitem"><p>
      Avoid data loss when DDL operations that don't take a strong lock
      affect tables that are being logically replicated (Shlok Kyal,
      Hayato Kuroda)
      <a class="ulink" href="https://postgr.es/c/0434033e8" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/bb1bc9fa9" target="_top">§</a>
     </p><p>
      The catalog changes caused by the DDL command were not reflected
      into WAL-decoding processes, allowing them to decode subsequent
      changes using stale catalog data, probably resulting in data
      corruption.
     </p></li><li class="listitem"><p>
      Avoid duplicate snapshot creation in logical replication index
      lookups (Heikki Linnakangas)
      <a class="ulink" href="https://postgr.es/c/2ef048855" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/136e68b46" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Fix assertion failure in snapshot building (Masahiko Sawada)
      <a class="ulink" href="https://postgr.es/c/7be51eb4e" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Fix overly-strict assertion
      in <code class="function">gistFindCorrectParent()</code> (Heikki Linnakangas)
      <a class="ulink" href="https://postgr.es/c/a749c6f18" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Fix rare assertion failure in standby servers when the primary is
      restarted (Heikki Linnakangas)
      <a class="ulink" href="https://postgr.es/c/66235baab" target="_top">§</a>
     </p></li><li class="listitem"><p>
      In PL/pgSQL, avoid <span class="quote">“<span class="quote">unexpected plan node type</span>”</span> error
      when a scrollable cursor is defined on a
      simple <code class="literal">SELECT <em class="replaceable"><code>expression</code></em></code>
      query (Andrei Lepikhov)
      <a class="ulink" href="https://postgr.es/c/c196c610b" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Don't try to drop individual index partitions
      in <span class="application">pg_dump</span>'s <code class="option">--clean</code>
      mode (Jian He)
      <a class="ulink" href="https://postgr.es/c/148cc0105" target="_top">§</a>
     </p><p>
      The server rejects such <code class="command">DROP</code> commands.  That has
      no real consequences, since the partitions will go away anyway in
      the subsequent <code class="command">DROP</code>s of either their parent
      tables or their partitioned index.  However, the error reported for
      the attempted drop causes problems when restoring
      in <code class="option">--single-transaction</code> mode.
     </p></li><li class="listitem"><p>
      In <span class="application">pg_dumpall</span>, avoid emitting invalid
      role <code class="command">GRANT</code> commands
      if <code class="structname">pg_auth_members</code> contains invalid role
      OIDs (Tom Lane)
      <a class="ulink" href="https://postgr.es/c/ce1475acd" target="_top">§</a>
     </p><p>
      Instead, print a warning and skip the entry.  This copes better with
      catalog corruption that has been seen to occur in back branches as a
      result of race conditions between <code class="command">GRANT</code>
      and <code class="command">DROP ROLE</code>.
     </p></li><li class="listitem"><p>
      In <span class="application">pg_amcheck</span>
      and <span class="application">pg_upgrade</span>, use the correct function
      to free allocations made by <span class="application">libpq</span>
      (Michael Paquier, Ranier Vilela)
      <a class="ulink" href="https://postgr.es/c/35a591a04" target="_top">§</a>
     </p><p>
      These oversights could result in crashes in certain Windows build
      configurations, such as a debug build
      of <span class="application">libpq</span> used by a non-debug build of the
      calling application.
     </p></li><li class="listitem"><p>
      Allow <code class="filename">contrib/dblink</code> queries to be interrupted
      by query cancel (Noah Misch)
      <a class="ulink" href="https://postgr.es/c/a8a918937" target="_top">§</a>
      <a class="ulink" href="https://postgr.es/c/aa435d7c4" target="_top">§</a>
     </p><p>
      This change back-patches a v17-era fix.  It prevents possible hangs
      in <code class="command">CREATE DATABASE</code> and <code class="command">DROP
      DATABASE</code> due to failure to detect deadlocks.
     </p></li><li class="listitem"><p>
      Avoid crashing with corrupt input data
      in <code class="filename">contrib/pageinspect</code>'s
      <code class="function">heap_page_items()</code> (Dmitry Kovalenko)
      <a class="ulink" href="https://postgr.es/c/3c2ea65bd" target="_top">§</a>
     </p></li><li class="listitem"><p>
      Prevent assertion failure
      in <code class="filename">contrib/pg_freespacemap</code>'s
      <code class="function">pg_freespacemap()</code> (Tender Wang)
      <a class="ulink" href="https://postgr.es/c/5ff827389" target="_top">§</a>
     </p><p>
      Applying <code class="function">pg_freespacemap()</code> to a relation
      lacking storage (such as a view) caused an assertion failure,
      although there was no ill effect in non-assert builds.
      Add an error check to reject that case.
     </p></li><li class="listitem"><p>
      Fix build failure on macOS 15.4 (Tom Lane, Peter Eisentraut)
      <a class="ulink" href="https://postgr.es/c/71790aef1" target="_top">§</a>
     </p><p>
      This macOS update broke our configuration probe
      for <code class="function">strchrnul()</code>.
     </p></li><li class="listitem"><p>
      Update time zone data files to <span class="application">tzdata</span>
      release 2025b for DST law changes in Chile, plus historical
      corrections for Iran (Tom Lane)
      <a class="ulink" href="https://postgr.es/c/fa4244a43" target="_top">§</a>
     </p><p>
      There is a new time zone America/Coyhaique for Chile's Aysén Region,
      to account for it changing to UTC-03 year-round and thus diverging
      from America/Santiago.
     </p></li></ul></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-14-19.html" title="E.1. Release 14.19">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html" title="Appendix E. Release Notes">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-14-17.html" title="E.3. Release 14.17">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.1. Release 14.19 </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 14.19 Documentation">Home</a></td><td width="40%" align="right" valign="top"> E.3. Release 14.17</td></tr></table></div></body></html>